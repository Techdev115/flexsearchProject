/*
 FlexSearch v0.3.1
 Copyright 2019 Nextapps GmbH
 Author: Thomas Wilkerling
 Released under the Apache 2.0 Licence
 https://github.com/nextapps-de/flexsearch
*/
'use strict';(function(d,t,q){var r;(r=q.define)&&r.amd?r([],function(){return t}):(r=q.modules)?r[d.toLowerCase()]=t:"object"===typeof exports?module.exports=t:q[d]=t})("FlexSearch",function(){function d(a){a||(a=v);this.id=a.id||G++;this.init(a);t(this,"index",function(){return this.a});t(this,"length",function(){return Object.keys(this.a).length})}function t(a,b,c){Object.defineProperty(a,b,{get:c})}function q(a,b){for(var c=0;c<b.length;c+=2)a=a.replace(b[c],b[c+1]);return a}function r(a,b,c,
e,f,u,g){if(b[c])return b[c];f=f?(9-(g||6))*u+(g||6)*f:u;b[c]=f;f>=g&&(a=a[f+.5>>0],a=a[c]||(a[c]=[]),a[a.length]=e);return f}function y(a,b){if(a)for(var c=Object.keys(a),e=0,f=c.length;e<f;e++){var u=c[e],g=a[u];if(g)for(var h=0,k=g.length;h<k;h++)if(g[h]===b){1===k?delete a[u]:g.splice(h,1);break}else"object"===typeof g[h]&&y(g[h],b)}}function H(a,b){a=a.length-b.length;return 0>a?1:a?-1:0}function I(a,b){a=a.length-b.length;return 0>a?-1:a?1:0}function x(a){return"function"===typeof a}function z(a){return"undefined"===
typeof a}function B(a){for(var b=Array(a),c=0;c<a;c++)b[c]={};return b}var v={encode:"icase",mode:"forward",h:!1,cache:!1,async:!1,i:!1,threshold:0,depth:0},A=[],G=0,C=/[ -/]/g,D={},E={},F=function(){for(var a=Object.getOwnPropertyNames({}.__proto__),b={},c=0;c<a.length;c++)b[a[c]]=1;return b}();d.create=function(a){return new d(a)};d.registerMatcher=function(a){for(var b in a)a.hasOwnProperty(b)&&A.push(new RegExp(b,"g"),a[b]);return this};d.registerEncoder=function(a,b){w[a]=b.bind(w);return this};
d.registerLanguage=function(a,b){D[a]=b.filter;E[a]=b.stemmer;return this};d.encode=function(a,b){return F[a]?b:w[a](b)};d.prototype.init=function(a){this.g=[];a||(a=v);var b=a.profile,c={};this.mode=a.mode||c.mode||this.mode||v.mode;this.threshold=z(b=a.threshold)?c.threshold||this.threshold||v.threshold:b;this.depth=z(b=a.depth)?c.depth||this.depth||v.depth:b;this.c=(b=z(b=a.encode)?c.encode:b)&&w[b]&&w[b].bind(w)||(x(b)?b:this.c||!1);(b=a.matcher)&&this.addMatcher(b);if(b=a.filter){b=D[b]||b;c=
this.c;var e={};if(b)for(var f=0;f<b.length;f++){var u=c?c(b[f]):b[f];e[u]=String.fromCharCode(65E3-b.length+f)}this.filter=e}if(b=a.stemmer){a=E[b]||b;b=this.c;c=[];if(a)for(var g in a)a.hasOwnProperty(g)&&(e=b?b(g):g,c.push(new RegExp("(?=.{"+(e.length+3)+",})"+e+"$","g"),b?b(a[g]):a[g]));this.stemmer=c}this.f=B(10);this.b={};this.a={};return this};d.prototype.encode=function(a){a&&A.length&&(a=q(a,A));a&&this.g.length&&(a=q(a,this.g));a&&this.c&&(a=this.c(a));a&&this.stemmer&&(a=q(a,this.stemmer));
return a};d.prototype.addMatcher=function(a){var b=this.g,c;for(c in a)a.hasOwnProperty(c)&&b.push(new RegExp(c,"g"),a[c]);return this};d.prototype.add=function(a,b,c){if(b&&"string"===typeof b&&(a&&!F[a]||0===a))if(this.a[a]&&!c)this.update(a,b);else{b=this.encode(b);if(!b.length)return this;c=this.mode;b=x(c)?c(b):b.split(C);for(var e={_ctx:{}},f=this.threshold,u=this.depth,g=this.f,h=b.length,k=0;k<h;k++){var l=b[k];if(l){var d=l.length,m=(h-k)/h,n="";switch(c){case "reverse":case "both":for(var p=
d-1;1<=p;p--)n=l[p]+n,r(g,e,n,a,(d-p)/d,m,f);n="";case "forward":for(p=0;p<d;p++)n+=l[p],r(g,e,n,a,1,m,f);break;case "full":for(p=0;p<d;p++)for(var t=(d-p)/d,q=d;q>p;q--)n=l.substring(p,q),r(g,e,n,a,t,m,f);break;default:if(d=r(g,e,l,a,1,m,f),u&&1<h&&d>=f)for(d=e._ctx[l]||(e._ctx[l]={}),l=this.b[l]||(this.b[l]=B(10)),m=k-u,n=k+u+1,0>m&&(m=0),n>h&&(n=h);m<n;m++)m!==k&&r(l,d,b[m],a,0,10-(m<k?k-m:m-k),f)}}}this.a[a]=1}return this};d.prototype.update=function(a,b){this.a[a]&&"string"===typeof b&&(this.remove(a),
this.add(a,b,!0));return this};d.prototype.remove=function(a){if(this.a[a]){for(var b=0;10>b;b++)y(this.f[b],a);this.depth&&y(this.b,a);delete this.a[a]}return this};d.prototype.search=function(a,b,c){var e=a,f=[];if("object"===typeof a){b=a.limit;var d=a.threshold;a=a.query}d||(d=this.threshold||0);x(b)?(c=b,b=1E3):b||0===b||(b=1E3);if(c)c(this.search(e,b,null,!0));else{if(!a||"string"!==typeof a)return f;e=this.encode(a);if(!e.length)return f;a=this.mode;a=x(a)?a(e):e.split(C);c=a.length;var g=
!0;e=[];var h={};if(1<c)if(this.depth){var k=!0;var l=a[0];h[l]=1}else a.sort(H);var q;if(!k||(q=this.b)[l])for(var m=k?1:0;m<c;m++){var n=a[m];if(n&&!h[n]){for(var p,r=!1,t=[],w=0,v=9;v>=d;v--)if(p=(k?q[l]:this.f)[v],p=p[n])t[w++]=p,r=!0;if(r)e[e.length]=1<w?e.concat.apply([],t):t[0];else{g=!1;break}h[n]=1}l=n}else g=!1;if(g)a:{d=[];f=e.length;if(1<f){e.sort(I);l={};k=e[0];q=k.length;for(a=0;a<q;)l[k[a++]]=1;for(h=g=0;++h<f;){m=!1;n=h===f-1;k=e[h];q=k.length;for(a=0;a<q;)if(c=k[a++],l[c]&&l[c]===
h){if(n){if(d[g++]=c,b&&g===b){f=d;break a}}else l[c]=h+1;m=!0}if(!m)break}}else f&&(d=e[0],b&&d.length>b&&(d=d.slice(0,b)));f=d}return f}};d.prototype.clear=function(){this.destroy();return this.init()};d.prototype.destroy=function(){this.filter=this.stemmer=this.f=this.b=this.a=null;return this};var w={icase:function(a){return a.toLowerCase()}};return d}(!1),this);
