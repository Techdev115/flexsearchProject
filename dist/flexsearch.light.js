/*
 FlexSearch v0.5.3
 Copyright 2019 Nextapps GmbH
 Author: Thomas Wilkerling
 Released under the Apache 2.0 Licence
 https://github.com/nextapps-de/flexsearch
*/
'use strict';(function(f,w,y){let m;(m=y.define)&&m.amd?m([],function(){return w}):(m=y.modules)?m[f.toLowerCase()]=w:"object"===typeof exports?module.exports=w:y[f]=w})("FlexSearch",function(){function f(a,c){const b=c?c.id:a&&a.id;this.id=b||0===b?b:M++;this.init(a,c);y(this,"index",function(){return this.b});y(this,"length",function(){return Object.keys(this.b).length})}function w(a,c){const b=a.length,e=A(c),d=[];for(let l=0,g=0;l<b;l++){const b=a[l];if(e&&c(b)||!e&&!c[b])d[g++]=b}return d}function y(a,
c,b){Object.defineProperty(a,c,{get:b})}function m(a,c){for(let b=0;b<c.length;b+=2)a=a.replace(c[b],c[b+1]);return a}function B(a,c,b,e,d,l,g,h){if(c[b])return c[b];d=d?(h-(g||h/1.5))*l+(g||h/1.5)*d:l;c[b]=d;d>=g&&(a=a[h-(d+.5>>0)],a=a[b]||(a[b]=[]),a[a.length]=e);return d}function F(a,c){if(a){const b=Object.keys(a);for(let e=0,d=b.length;e<d;e++){const d=b[e],g=a[d];if(g)for(let b=0,e=g.length;b<e;b++)if(g[b]===c){1===e?delete a[d]:g.splice(b,1);break}else"object"===typeof g[b]&&F(g[b],c)}}}function N(a,
c){a=a.length-c.length;return 0>a?1:a?-1:0}function O(a,c,b,e,d){e=[];let l;const g=a.length;if(1<g){c="or"===c;const E=v();let k,f=-1,p,q=0,u,r,x=!0,n=0;for(;++f<g;){const m=f===g-1;k=a[f];p=k.length;if(!p){if(!c&&!d)return e;if(m&&!n)return u||e;continue}if(x){if(m)return k;for(;q<p;)E["@"+k[q++]]=1;u=k;x=!1;continue}let H=!1;l=[];for(q=0;q<p;){r=k[q++];var h="@"+r;if(E[h]){const a=E[h];if(c||a===f){if(m){if(e[n++]=r,b&&n===b)return e}else E[h]=f+1;H=!0}else d&&(h=l[a]||(l[a]=[]),h[h.length]=r)}}if(!H&&
!d)break}if(d&&(n=e.length,(f=l.length)&&(!b||n<b)))for(;f--;)if(r=l[f])for(q=0,p=r.length;q<p;q++)if(e[n++]=r[q],b&&n===b)return e}else g&&(e=a[0],b&&e.length>b&&(e=e.slice(0,b)));return e}function C(a){return"string"===typeof a}function A(a){return"function"===typeof a}function D(a){return"undefined"===typeof a}function I(a){const c=Array(a);for(let b=0;b<a;b++)c[b]=v();return c}function v(){return Object.create(null)}const t={encode:"icase",c:"forward",o:!1,cache:!1,async:!1,s:!1,i:!1,m:!1,l:!1,
a:9,threshold:0,depth:0},G=[];let M=0;const J=/\W+/,K={},L={};f.create=function(a){return new f(a)};f.registerMatcher=function(a){for(const c in a)a.hasOwnProperty(c)&&G.push(new RegExp(c,"g"),a[c]);return this};f.registerEncoder=function(a,c){z[a]=c.bind(z);return this};f.registerLanguage=function(a,c){K[a]=c.filter;L[a]=c.stemmer;return this};f.encode=function(a,c){return z[a](c)};f.prototype.init=function(a,c){this.j=[];if(c){var b=c.preset;a=c}else a||(a=t),b=a.preset;c={};this.c=a.tokenize||
c.c||this.c||t.c;this.i=a.rtl||this.i||t.i;this.threshold=D(b=a.threshold)?c.threshold||this.threshold||t.threshold:b;this.a=D(b=a.resolution)?b=c.a||this.a||t.a:b;b<=this.threshold&&(this.a=this.threshold+1);this.depth=D(b=a.depth)?c.depth||this.depth||t.depth:b;this.l=D(b=a.paging)?this.l||t.l:b;this.g=(b=D(b=a.encode)?c.encode||t.encode:b)&&z[b]&&z[b].bind(z)||(A(b)?b:this.g||!1);(b=a.matcher)&&this.addMatcher(b);if(b=a.filter){C(b)&&(b=K[b]);if(b.constructor===Array){c=this.g;var e=v();for(let a=
0;a<b.length;a++){const d=c?c(b[a]):b[a];e[d]=1}b=e}this.filter=b}if(b=a.stemmer){var d;a=C(b)?L[b]:b;b=this.g;c=[];for(d in a)a.hasOwnProperty(d)&&(e=b?b(d):d,c.push(new RegExp(e+"($|\\W)","g"),b?b(a[d]):a[d]));this.stemmer=d=c}this.h=I(this.a-(this.threshold||0));this.f=v();this.b=v();return this};f.prototype.encode=function(a){a&&G.length&&(a=m(a,G));a&&this.j.length&&(a=m(a,this.j));a&&this.g&&(a=this.g(a));a&&this.stemmer&&(a=m(a,this.stemmer));return a};f.prototype.addMatcher=function(a){const c=
this.j;for(const b in a)a.hasOwnProperty(b)&&c.push(new RegExp(b,"g"),a[b]);return this};f.prototype.add=function(a,c,b,e,d){if(c&&C(c)&&(a||0===a)){const m="@"+a;if(this.b[m]&&!e)return this.update(a,c);if(!d&&b)return this.add(a,c,null,e,!0),b(),this;c=this.encode(c);if(!c.length)return this;b=this.c;c=A(b)?b(c):c.split(J);this.filter&&(c=w(c,this.filter));e=v();e._ctx=v();d=c.length;const p=this.threshold,q=this.depth,u=this.a,r=this.h,x=this.i;for(let n=0;n<d;n++){var l=c[n];if(l){var g=l.length,
h=(x?n+1:d-n)/d,f="";switch(b){case "reverse":case "both":for(var k=g;--k;)f=l[k]+f,B(r,e,f,a,x?1:(g-k)/g,h,p,u-1);f="";case "forward":for(k=0;k<g;k++)f+=l[k],B(r,e,f,a,x?(k+1)/g:1,h,p,u-1);break;case "full":for(k=0;k<g;k++){const b=(x?k+1:g-k)/g;for(let c=g;c>k;c--)f=l.substring(k,c),B(r,e,f,a,b,h,p,u-1)}break;default:if(g=B(r,e,l,a,1,h,p,u-1),q&&1<d&&g>=p)for(g=e._ctx[l]||(e._ctx[l]=v()),l=this.f[l]||(this.f[l]=I(u-(p||0))),h=n-q,f=n+q+1,0>h&&(h=0),f>d&&(f=d);h<f;h++)h!==n&&B(l,g,c[h],a,0,u-(h<
n?n-h:h-n),p,u-1)}}}this.b[m]=1}return this};f.prototype.update=function(a,c,b){this.b["@"+a]&&C(c)&&(this.remove(a),this.add(a,c,b,!0));return this};f.prototype.remove=function(a,c,b){const e="@"+a;if(this.b[e]){if(!b&&c)return this.remove(a,null,!0),c(),this;for(c=0;c<this.a-(this.threshold||0);c++)F(this.h[c],a);this.depth&&F(this.f,a);delete this.b[e]}return this};f.prototype.search=function(a,c,b,e){var d=a;let f,g=[];"object"===typeof a&&(c=a.limit,f=a.threshold,a=a.query);f||(f=this.threshold||
0);A(c)?(b=c,c=1E3):c||0===c||(c=1E3);if(!e&&b)return b(this.search(d,c,null,!0)),this;if(!a||!C(a))return g;d=this.encode(a);if(!d.length)return g;a=this.c;d=A(a)?a(d):d.split(J);this.filter&&(d=w(d,this.filter));a=d.length;b=!0;e=[];const h=v();let m;if(1<a)if(this.depth){m=!0;var k=d[0];h[k]=1}else d.sort(N);let t;if(!m||(t=this.f)[k]){let c=this.a;for(let g=m?1:0;g<a;g++){const a=d[g];if(a){if(!h[a]){const d=[];let g=!1,l=0;if(k=m?t[k]:this.h){let b;for(let e=0;e<c-f;e++)if(b=k[e][a])d[l++]=b,
g=!0}if(g)e[e.length]=1<l?d.concat.apply([],d):d[0];else{b=!1;break}h[a]=1}k=a}}}else b=!1;b&&(g=O(e,!1,c,void 0,!1));return g};f.prototype.clear=function(){return this.destroy().init()};f.prototype.destroy=function(){this.h=this.f=this.b=null;return this};const z={icase:function(a){return a.toLowerCase()}};return f}(!1),this);
