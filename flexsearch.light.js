/*
 FlexSearch v0.3.0
 Copyright 2019 Nextapps GmbH
 Author: Thomas Wilkerling
 Released under the Apache 2.0 Licence
 https://github.com/nextapps-de/flexsearch
*/
'use strict';(function(h,w,u){var r;(r=u.define)&&r.amd?r([],function(){return w}):(r=u.modules)?r[h.toLowerCase()]=w:"object"===typeof exports?module.exports=w:u[h]=w})("FlexSearch",function(){function h(a){a||(a=x);this.id=a.id||F++;this.init(a);w(this,"index",function(){return this.a});w(this,"length",function(){return Object.keys(this.a).length})}function w(a,b,c){Object.defineProperty(a,b,{get:c})}function u(a,b,c){if("undefined"===typeof c){for(c=0;c<b.length;c+=2)a=a.replace(b[c],b[c+1]);return a}return a.replace(b,
c)}function r(a,b,c,e,f,v,d){if(b[c])return b[c];f=f?(9-(d||6))*v+(d||6)*f:v;b[c]=f;f>=d&&(a=a[f+.5>>0],a=a[c]||(a[c]=[]),a[a.length]=e);return f}function z(a,b){if(a)for(var c=Object.keys(a),e=0,f=c.length;e<f;e++){var v=c[e],d=a[v];if(d)for(var k=0,n=d.length;k<n;k++)if(d[k]===b){1===n?delete a[v]:d.splice(k,1);break}else"object"===typeof d[k]&&z(d[k],b)}}function G(a,b){a=a.length-b.length;return 0>a?1:a?-1:0}function H(a,b){a=a.length-b.length;return 0>a?-1:a?1:0}function B(a){for(var b=Array(a),
c=0;c<a;c++)b[c]={};return b}var x={encode:"icase",mode:"forward",f:!1,cache:!1,async:!1,i:!1,threshold:0,depth:0},A=[],F=0,C=/[ -/]/g,D={},E={};h.create=function(a){return new this(a)};h.registerMatcher=function(a){for(var b in a)a.hasOwnProperty(b)&&A.push(new RegExp(b,"g"),a[b]);return this};h.registerEncoder=function(a,b){y[a]=b.bind(y);return this};h.registerLanguage=function(a,b){D[a]=b.filter;E[a]=b.stemmer;return this};h.encode=function(a,b){return y[a](b)};h.prototype.init=function(a){this.h=
[];a||(a=x);var b={};this.mode=a.mode||b.mode||this.mode||x.mode;this.threshold=a.threshold||b.threshold||this.threshold||x.threshold;this.depth=a.depth||b.depth||this.depth||x.depth;this.f=a.suggest||this.f||x.f;this.c=(b=a.encode||b.encode)&&y[b]&&y[b].bind(y)||("function"===typeof b?b:this.c||!1);(b=a.matcher)&&this.addMatcher(b);if(b=a.filter){b=D[b]||b;var c=this.c,e={};if(b)for(var f=0;f<b.length;f++){var v=c?c(b[f]):b[f];e[v]=String.fromCharCode(65E3-b.length+f)}this.filter=e}if(b=a.stemmer){a=
E[b]||b;b=this.c;c=[];if(a)for(var d in a)a.hasOwnProperty(d)&&(e=b?b(d):d,c.push(new RegExp("(?=.{"+(e.length+3)+",})"+e+"$","g"),b?b(a[d]):a[d]));this.stemmer=c}this.g=B(10);this.b={};this.a={};return this};h.prototype.encode=function(a){a&&A.length&&(a=u(a,A));a&&this.h.length&&(a=u(a,this.h));a&&this.c&&(a=this.c(a));a&&this.stemmer&&(a=u(a,this.stemmer));return a};h.prototype.addMatcher=function(a){var b=this.h,c;for(c in a)a.hasOwnProperty(c)&&b.push(new RegExp(c,"g"),a[c]);return this};h.prototype.add=
function(a,b,c){if(b&&"string"===typeof b&&(a||0===a))if(this.a[a]&&!c)this.update(a,b);else{b=this.encode(b);if(!b.length)return this;c=this.mode;b="function"===typeof c?c(b):b.split(C);for(var e={_ctx:{}},f=this.threshold,v=this.depth,d=this.g,k=b.length,n=0;n<k;n++){var m=b[n];if(m){var q=m.length,l=(k-n)/k,g="";switch(c){case "reverse":case "both":for(var p=q-1;1<=p;p--)g=m[p]+g,r(d,e,g,a,(q-p)/q,l,f);g="";case "forward":for(p=0;p<q;p++)g+=m[p],r(d,e,g,a,1,l,f);break;case "full":for(p=0;p<q;p++)for(var h=
(q-p)/q,t=q;t>p;t--)g=m.substring(p,t),r(d,e,g,a,h,l,f);break;default:if(q=r(d,e,m,a,1,l,f),v&&1<k&&q>=f)for(q=e._ctx[m]||(e._ctx[m]={}),m=this.b[m]||(this.b[m]=B(10)),l=n-v,g=n+v+1,0>l&&(l=0),g>k&&(g=k);l<g;l++)l!==n&&r(m,q,b[l],a,0,10-(l<n?n-l:l-n),f)}}}this.a[a]="1"}return this};h.prototype.update=function(a,b){this.a[a]&&b&&"string"===typeof b&&(this.remove(a),this.add(a,b,!0));return this};h.prototype.remove=function(a){if(this.a[a]){for(var b=0;10>b;b++)z(this.g[b],a);this.depth&&z(this.b,a);
delete this.a[a]}return this};h.prototype.search=function(a,b,c){var e=[];if("object"===typeof a){c=a.callback||b;b=a.limit;var f=a.threshold;a=a.query}f||(f=this.threshold||0);"function"===typeof b?(c=b,b=1E3):b||0===b||(b=1E3);if(c)c(this.search(a,b));else{if(!a||"string"!==typeof a)return e;a=this.encode(a);if(!a.length)return e;c=this.mode;c="function"===typeof c?c(a):a.split(C);var h=c.length,d=!0;a=[];var k={};if(1<h)if(this.depth){var n=!0;var m=c[0];k[m]="1"}else c.sort(G);var q;if(!n||(q=
this.b)[m])for(var l=n?1:0;l<h;l++){var g=c[l];if(g&&!k[g]){for(var p,r=!1,t=[],w=0,u=9;u>=f;u--)p=(n?q[m]:this.g)[u],p[g]&&(t[w++]=p[g],r=!0);if(r)a[a.length]=1<w?a.concat.apply([],t):t[0];else if(!this.f){d=!1;break}k[g]="1"}m=g}else d=!1;if(d)a:if(f=this.f,e=[],m=[],n=a.length,1<n){a.sort(H);q={};c=a[0];h=c.length;for(d=0;d<h;)q[c[d++]]=1;l=0;for(g=1;g<n;){p=!1;r=g===n-1;m=[];c=a[g];h=c.length;for(d=-1;d<h;)if(k=c[++d],q[k])if(t=q[k],t===g){if(r){if(e[l++]=k,b&&l===b)break a}else q[k]=g+1;p=!0}else f&&
(t=m[t]?m[t]:m[t]=[],t[t.length]=k);if(!p&&!f)break;g++}if(f&&(l=e.length,(h=m.length)&&(!b||l<b)))for(g=h-1;0<=g;g--)if(k=m[g])for(d=0;d<k.length;d++)if(e[l++]=k[d],b&&l===b)break a}else n&&(e=a[0],b&&e.length>b&&(e=e.slice(0,b)));return e}};h.prototype.clear=function(){this.destroy();return this.init()};h.prototype.destroy=function(){this.filter=this.stemmer=this.g=this.b=this.a=null;return this};var y={icase:function(a){return a.toLowerCase()}};return h}(!1),this);
