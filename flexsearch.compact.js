/*
 FlexSearch v0.3.0
 Copyright 2019 Nextapps GmbH
 Author: Thomas Wilkerling
 Released under the Apache 2.0 Licence
 https://github.com/nextapps-de/flexsearch
*/
'use strict';(function(m,x,c){var r;(r=c.define)&&r.amd?r([],function(){return x}):(r=c.modules)?r[m.toLowerCase()]=x:"object"===typeof exports?module.exports=x:c[m]=x})("FlexSearch",function(){function m(b){"string"===typeof b&&(b=D[b]);b||(b=v);this.id=b.id||J++;this.init(b);x(this,"index",function(){return this.a});x(this,"length",function(){return Object.keys(this.a).length})}function x(b,a,d){Object.defineProperty(b,a,{get:d})}function c(b){return new RegExp(b,"g")}function r(b,a,d){if("undefined"===
typeof d){for(d=0;d<a.length;d+=2)b=b.replace(a[d],a[d+1]);return b}return b.replace(a,d)}function z(b,a,d,n,g,e,c){if(a[d])return a[d];g=g?(9-(c||6))*e+(c||6)*g:e;a[d]=g;g>=c&&(b=b[g+.5>>0],b=b[d]||(b[d]=[]),b[b.length]=n);return g}function A(b,a){if(b)for(var d=Object.keys(b),n=0,g=d.length;n<g;n++){var c=d[n],k=b[c];if(k)for(var f=0,h=k.length;f<h;f++)if(k[f]===a){1===h?delete b[c]:k.splice(f,1);break}else"object"===typeof k[f]&&A(k[f],a)}}function E(b){var a=[];if(!b)return a;for(var d=0,n=0,
c=0,e="",k=b.length,f=0;f<k;f++){var h=b[f];"a"===h||"e"===h||"i"===h||"o"===h||"u"===h||"y"===h?d++:n++;" "!==h&&(e+=h);if(" "===h||d>=(8<k?2:1)&&2<=n||2<=d&&n>=(8<k?2:1)||f===k-1)e&&(a[c]&&2<e.length&&c++,a[c]=a[c]?a[c]+e:e," "===h&&c++,e=""),n=d=0}return a}function B(b){for(var a="",d="",n="",c=0;c<b.length;c++){var e=b[c];if(e!==d)if(c&&"h"===e){if(n="a"===n||"e"===n||"i"===n||"o"===n||"u"===n||"y"===n,("a"===d||"e"===d||"i"===d||"o"===d||"u"===d||"y"===d)&&n||" "===d)a+=e}else a+=e;n=c===b.length-
1?"":b[c+1];d=e}return a}function K(b,a){b=b.length-a.length;return 0>b?1:b?-1:0}function L(b,a){b=b.length-a.length;return 0>b?-1:b?1:0}function F(b){for(var a=Array(b),d=0;d<b;d++)a[d]={};return a}var v={encode:"icase",mode:"forward",g:!1,cache:!1,async:!1,m:!1,threshold:0,depth:0},D={memory:{encode:"extra",mode:"strict",threshold:7},speed:{encode:"icase",mode:"strict",threshold:7,depth:2},match:{encode:"extra",mode:"full"},score:{encode:"extra",mode:"strict",threshold:5,depth:4},balance:{encode:"balance",
mode:"strict",threshold:6,depth:3},fastest:{encode:"icase",mode:"strict",threshold:9,depth:1}},C=[],J=0,G=c("[ -/]"),H={},I={};m.create=function(b){return new this(b)};m.registerMatcher=function(b){for(var a in b)b.hasOwnProperty(a)&&C.push(c(a),b[a]);return this};m.registerEncoder=function(b,a){y[b]=a.bind(y);return this};m.registerLanguage=function(b,a){H[b]=a.filter;I[b]=a.stemmer;return this};m.encode=function(b,a){return y[b](a)};m.prototype.init=function(b){this.j=[];b||(b=v);var a=b.profile;
a=a?D[a]:{};this.mode=b.mode||a.mode||this.mode||v.mode;this.threshold=b.threshold||a.threshold||this.threshold||v.threshold;this.depth=b.depth||a.depth||this.depth||v.depth;this.g=b.suggest||this.g||v.g;this.f=(a=b.encode||a.encode)&&y[a]&&y[a].bind(y)||("function"===typeof a?a:this.f||!1);(a=b.matcher)&&this.addMatcher(a);if(a=b.filter){a=H[a]||a;var d=this.f,n={};if(a)for(var g=0;g<a.length;g++){var e=d?d(a[g]):a[g];n[e]=String.fromCharCode(65E3-a.length+g)}this.filter=n}if(a=b.stemmer){a=I[a]||
a;d=this.f;n=[];if(a)for(var k in a)a.hasOwnProperty(k)&&(g=d?d(k):k,n.push(c("(?=.{"+(g.length+3)+",})"+g+"$"),d?d(a[k]):a[k]));this.stemmer=n}this.i=F(10);this.c={};this.a={};this.h=!0;this.b=(this.cache=a=b.cache||this.cache||v.cache)?new M(a):!1;return this};m.prototype.encode=function(b){b&&C.length&&(b=r(b,C));b&&this.j.length&&(b=r(b,this.j));b&&this.f&&(b=this.f(b));b&&this.stemmer&&(b=r(b,this.stemmer));return b};m.prototype.addMatcher=function(b){var a=this.j,d;for(d in b)b.hasOwnProperty(d)&&
a.push(c(d),b[d]);return this};m.prototype.add=function(b,a,d){if(a&&"string"===typeof a&&(b||0===b))if(this.a[b]&&!d)this.update(b,a);else{a=this.encode(a);if(!a.length)return this;d=this.mode;a="function"===typeof d?d(a):"ngram"===d?E(a):a.split(G);for(var c={_ctx:{}},g=this.threshold,e=this.depth,k=this.i,f=a.length,h=0;h<f;h++){var u=a[h];if(u){var p=u.length,t=(f-h)/f,q="";switch(d){case "reverse":case "both":for(var l=p-1;1<=l;l--)q=u[l]+q,z(k,c,q,b,(p-l)/p,t,g);q="";case "forward":for(l=0;l<
p;l++)q+=u[l],z(k,c,q,b,1,t,g);break;case "full":for(l=0;l<p;l++)for(var m=(p-l)/p,r=p;r>l;r--)q=u.substring(l,r),z(k,c,q,b,m,t,g);break;default:if(p=z(k,c,u,b,1,t,g),e&&1<f&&p>=g)for(p=c._ctx[u]||(c._ctx[u]={}),u=this.c[u]||(this.c[u]=F(10)),t=h-e,q=h+e+1,0>t&&(t=0),q>f&&(q=f);t<q;t++)t!==h&&z(u,p,a[t],b,0,10-(t<h?h-t:t-h),g)}}}this.a[b]="1";this.h=!1}return this};m.prototype.update=function(b,a){this.a[b]&&a&&"string"===typeof a&&(this.remove(b),this.add(b,a,!0));return this};m.prototype.remove=
function(b){if(this.a[b]){for(var a=0;10>a;a++)A(this.i[a],b);this.depth&&A(this.c,b);delete this.a[b];this.h=!1}return this};m.prototype.search=function(b,a,d){var c=[];if("object"===typeof b){d=b.callback||a;a=b.limit;var g=b.threshold;b=b.query}g||(g=this.threshold||0);"function"===typeof a?(d=a,a=1E3):a||0===a||(a=1E3);if(d)d(this.search(b,a));else{if(!b||"string"!==typeof b)return c;d=b;if(this.cache)if(this.h){var e=this.b.get(b);if(e)return e}else this.b.clear(),this.h=!0;d=this.encode(d);
if(!d.length)return c;e=this.mode;e="function"===typeof e?e(d):"ngram"===e?E(d):d.split(G);var k=e.length,f=!0;d=[];var h={};if(1<k)if(this.depth){var u=!0;var p=e[0];h[p]="1"}else e.sort(K);var t;if(!u||(t=this.c)[p])for(var q=u?1:0;q<k;q++){var l=e[q];if(l&&!h[l]){for(var m,r=!1,w=[],x=0,v=9;v>=g;v--)m=(u?t[p]:this.i)[v],m[l]&&(w[x++]=m[l],r=!0);if(r)d[d.length]=1<x?d.concat.apply([],w):w[0];else if(!this.g){f=!1;break}h[l]="1"}p=l}else f=!1;if(f)a:if(g=this.g,c=[],p=[],u=d.length,1<u){d.sort(L);
t={};e=d[0];k=e.length;for(f=0;f<k;)t[e[f++]]=1;q=0;for(l=1;l<u;){m=!1;r=l===u-1;p=[];e=d[l];k=e.length;for(f=-1;f<k;)if(h=e[++f],t[h])if(w=t[h],w===l){if(r){if(c[q++]=h,a&&q===a)break a}else t[h]=l+1;m=!0}else g&&(w=p[w]?p[w]:p[w]=[],w[w.length]=h);if(!m&&!g)break;l++}if(g&&(q=c.length,(k=p.length)&&(!a||q<a)))for(l=k-1;0<=l;l--)if(h=p[l])for(f=0;f<h.length;f++)if(c[q++]=h[f],a&&q===a)break a}else u&&(c=d[0],a&&c.length>a&&(c=c.slice(0,a)));this.cache&&this.b.set(b,c);return c}};m.prototype.clear=
function(){this.destroy();return this.init()};m.prototype.destroy=function(){this.cache&&(this.b.clear(),this.b=null);this.filter=this.stemmer=this.i=this.c=this.a=null;return this};var y={icase:function(b){return b.toLowerCase()},simple:function(){var b=[c("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]"),"a",c("[\u00e8\u00e9\u00ea\u00eb]"),"e",c("[\u00ec\u00ed\u00ee\u00ef]"),"i",c("[\u00f2\u00f3\u00f4\u00f5\u00f6\u0151]"),"o",c("[\u00f9\u00fa\u00fb\u00fc\u0171]"),"u",c("[\u00fd\u0177\u00ff]"),"y",c("\u00f1"),
"n",c("\u00e7"),"c",c("\u00df"),"s",c(" & ")," and ",c("[-/]")," ",c("[^a-z0-9 ]"),"",c("\\s\\s+")," "];return function(a){a=r(a.toLowerCase(),b);return" "!==a?a:""}}(),advanced:function(){var b=[c("ae"),"a",c("ai"),"ei",c("ay"),"ei",c("ey"),"ei",c("oe"),"o",c("ue"),"u",c("ie"),"i",c("sz"),"s",c("zs"),"s",c("sh"),"s",c("ck"),"k",c("cc"),"k",c("dt"),"t",c("ph"),"f",c("pf"),"f",c("ou"),"o",c("uo"),"u"];return function(a,d){if(!a)return a;a=this.simple(a);2<a.length&&(a=r(a,b));d||1<a.length&&(a=B(a));
return a}}(),extra:function(){var b=[c("p"),"b",c("z"),"s",c("[cgq]"),"k",c("n"),"m",c("d"),"t",c("[vw]"),"f",c("[aeiouy]"),""];return function(a){if(!a)return a;a=this.advanced(a,!0);if(1<a.length){a=a.split(" ");for(var d=0;d<a.length;d++){var c=a[d];1<c.length&&(a[d]=c[0]+r(c.substring(1),b))}a=a.join(" ");a=B(a)}return a}}(),balance:function(){var b=[c("[-/]")," ",c("[^a-z0-9 ]"),"",c("\\s\\s+")," "];return function(a){return B(r(a.toLowerCase(),b))}}()},M=function(){function b(a){this.clear();
this.l=!0!==a&&a}b.prototype.clear=function(){this.cache={};this.count={};this.index={};this.a=[]};b.prototype.set=function(a,b){if(this.l&&"undefined"===typeof this.cache[a]){var c=this.a.length;if(c===this.l){c--;var d=this.a[c];delete this.cache[d];delete this.count[d];delete this.index[d]}this.index[a]=c;this.a[c]=a;this.count[a]=-1;this.cache[a]=b;this.get(a)}else this.cache[a]=b};b.prototype.get=function(a){var b=this.cache[a];if(this.l&&b){var c=++this.count[a],g=this.index,e=g[a];if(0<e){for(var k=
this.a,f=e;this.count[k[--e]]<=c&&-1!==e;);e++;if(e!==f){for(c=f;c>e;c--)f=k[c-1],k[c]=f,g[f]=c;k[e]=a;g[a]=e}}}return b};return b}();return m}(!1),this);
