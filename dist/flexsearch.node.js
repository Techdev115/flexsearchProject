/**!
 * FlexSearch.js v0.7.0
 * Copyright 2019 Nextapps GmbH
 * Author: Thomas Wilkerling
 * Licence: Apache-2.0
 * https://github.com/nextapps-de/flexsearch
 */
(function(){'use strict';function w(a){return"string"===typeof a}function y(a){return a.constructor===Array}function A(a){return"function"===typeof a}function C(a){return"object"===typeof a}function F(a){return"undefined"===typeof a}function G(a){for(var b=Array(a),c=0;c<a;c++)b[c]=K();return b}function K(){return Object.create(null)}function aa(a,b){for(var c=0,e=b.length;c<e;c+=2)a=a.replace(b[c],b[c+1]);return a};L.prototype.export=function(a){var b=!a||F(a.serialize)||a.serialize;if(this.a){var c=!a||F(a.doc)||a.doc,e=!a||F(a.index)||a.index;a=[];var d=0;if(e)for(e=this.a.keys;d<e.length;d++){var h=this.a.index[e[d]];a[d]=[h.j,h.g,Object.keys(h.f)]}c&&(a[d]=this.l)}else a=[this.j,this.g,Object.keys(this.f)];b&&(a=JSON.stringify(a));return a};
L.prototype.import=function(a,b){if(!b||F(b.serialize)||b.serialize)a=JSON.parse(a);var c={};if(this.a){var e=!b||F(b.doc)||b.doc,d=0;if(!b||F(b.index)||b.index){b=this.a.keys;for(var h=b.length,f=a[0][2];d<f.length;d++)c[f[d]]=1;for(d=0;d<h;d++){f=this.a.index[b[d]];var g=a[d];g&&(f.j=g[0],f.g=g[1],f.f=c)}}e&&(this.l=C(e)?e:a[d])}else{e=a[2];for(d=0;d<e.length;d++)c[e[d]]=1;this.j=a[0];this.g=a[1];this.f=c}};L.prototype.find=function(a,b){return this.where(a,b,1)[0]||null};
L.prototype.where=function(a,b,c,e){var d=this.l,h=[],f=0,g;if(C(a)){c||(c=b);var k=Object.keys(a);var n=k.length;var r=!1;if(1===n&&"id"===k[0])return[d[a.id]];if((g=this.A)&&!e)for(var q=0;q<g.length;q++){var p=g[q],l=a[p];if(!F(l)){var m=this.w[p]["@"+l];if(0===--n)return m;k.splice(k.indexOf(p),1);delete a[p];break}}g=Array(n);for(q=0;q<n;q++)g[q]=k[q].split(":")}else{if(A(a)){b=e||Object.keys(d);c=b.length;for(k=0;k<c;k++)n=d[b[k]],a(n)&&(h[f++]=n);return h}if(F(b))return[d[a]];if("id"===a)return[d[b]];
k=[a];n=1;g=[a.split(":")];r=!0}e=m||e||Object.keys(d);q=e.length;for(p=0;p<q;p++){l=m?e[p]:d[e[p]];for(var v=!0,t=0;t<n;t++){r||(b=a[k[t]]);var u=g[t],x=u.length,z=l;if(1<x)for(var B=0;B<x;B++)z=z[u[B]];else z=z[u[0]];if(z!==b){v=!1;break}}if(v&&(h[f++]=l,c&&f===c))break}return h};function Q(a){this.clear();this.h=!0!==a&&a}Q.prototype.clear=function(){this.cache=K();this.count=K();this.index=K();this.b=[]};Q.prototype.set=function(a,b){if(this.h&&F(this.cache[a])){var c=this.b.length;if(c===this.h){c--;var e=this.b[c];delete this.cache[e];delete this.count[e];delete this.index[e]}this.b[c]=a;this.index[a]=c;this.count[a]=-1;this.cache[a]=b;this.get(a)}else this.cache[a]=b};
Q.prototype.get=function(a){var b=this.cache[a];if(this.h&&b){var c=++this.count[a],e=this.index,d=e[a];if(0<d){for(var h=this.b,f=d;this.count[h[--d]]<=c&&-1!==d;);d++;if(d!==f){for(c=f;c>d;c--)f=h[c-1],h[c]=f,e[f]=c;h[d]=a;e[a]=d}}}return b};var ba={memory:{encode:"extra",i:"strict",threshold:0,c:1},speed:{encode:"icase",i:"strict",threshold:1,c:3,depth:2},match:{encode:"extra",i:"full",threshold:1,c:3},score:{encode:"extra",i:"strict",threshold:1,c:9,depth:4},balance:{encode:"balance",i:"strict",threshold:0,c:3,depth:3},fast:{encode:"icase",i:"strict",threshold:8,c:9,depth:1}};var ca={encode:function(a){return a.toLowerCase()},i:"strict",split:/[\W_]+/,cache:!1,async:!1,B:!1,u:!1,a:!1,c:9,threshold:0,depth:0},da=0,S={};function L(a){if(!(this instanceof L))return new L(a);var b=a&&a.id;this.id=b||0===b?b:da++;this.init(a);ea(this,"index",function(){return Object.keys(this.f)});ea(this,"length",function(){return this.index.length})}L.registerCharset=function(a,b,c,e){a=S[a]||(S[a]={});a.s=b;a.split=c;a.u=e;return L};
L.registerLanguage=function(a,b,c,e){a=S[a]||(S[a]={});a.filter=b;a.v=c;a.m=e;return L};
L.prototype.init=function(a){this.m=[];var b;if(w(a))a=ba[a];else if(b=a.preset)a=Object.assign({},ba[b],a);this.s||(a?a=Object.assign({},ca,a):a=ca);if(a){var c=a.charset;var e=a.lang;this.h=a.tokenize;this.split=w(b=c||a.split)?S[b]?S[b].split:new RegExp(b,"g"):b;this.u=w(b=c||a.rtl)?S[b].u:b;this.async=a.async;this.threshold=a.threshold;this.c=(b=a.resolution)<=this.threshold?this.threshold+1:b;this.depth="strict"===this.h&&a.depth||0;this.s=w(b=c||a.encode)?S[-1===b.indexOf(":")?b+":default":
b].encode:b;if(c=b=e||a.matcher){b=w(b)?S[b].m:b;c=Object.keys(b);for(var d=c.length,h=Array(2*d),f=0,g=0;f<d;f++){var k=c[f];h[g++]=new RegExp(k,"g");h[g++]=b[k]}c=h}this.m=c;if(c=b=e||a.filter)for(b=w(b)?S[b].filter:b,c=K(),d=0;d<b.length;d++)c[b[d]]=1;this.filter=c;if(e=b=e||a.stemmer){e=w(b)?S[b].v:b;c=Object.keys(e);d=c.length;h=Array(2*d);for(g=f=0;f<d;f++)k=c[f],h[g++]=new RegExp(k+"(?!\\b)"+k+"(\\b)","g"),h[g++]=e[k];e=h}this.v=e;(this.a=c=(b=a.doc)&&fa(b))&&(a.doc=null)}this.j=G(this.c-(this.threshold||
0));this.g=K();this.f={};if(c){this.l=K();e=c.index={};b=c.keys=[];d=c.field;h=c.tag;f=c.store;y(c.id)||(c.id=c.id.split(":"));if(f){g=K();if(w(f))g[f]=1;else if(y(f))for(k=0;k<f.length;k++)g[f[k]]=1;else C(f)&&(g=f);c.store=g}if(h){this.w=K();f=K();if(d)if(w(d))f[d]=a;else if(y(d))for(g=0;g<d.length;g++)f[d[g]]=a;else C(d)&&(f=d);y(h)||(c.tag=h=[h]);for(d=0;d<h.length;d++)this.w[h[d]]=K();this.A=h;d=f}if(d){if(!y(d))if(C(d)){var n=d;c.field=d=Object.keys(d)}else c.field=d=[d];for(c=0;c<d.length;c++)h=
d[c],y(h)||(n&&(a=n[h]),b[c]=h,d[c]=h.split(":")),e[h]=new L(a)}}if(b=a.cache)this.o=!0,this.b=new Q(b);return this};function fa(a){var b=K(),c;for(c in a)if(a.hasOwnProperty(c)){var e=a[c];b[c]=y(e)?e.slice(0):C(e)?fa(e):e}return b}
L.prototype.add=function(a,b,c,e,d){if(this.a&&C(a))return T(this,"add",a,b);if(b&&w(b)&&(a||0===a)){if(this.f[a]&&!e)return this.update(a,b);if(!d){if(this.async){var h=this;d=new Promise(function(B){setTimeout(function(){h.add(a,b,null,e,!0);h=null;B()})});if(c)d.then(c);else return d;return this}if(c)return this.add(a,b,null,e,!0),c(),this}b=this.encode(b);if(!b.length)return this;c=this.i(b);d=K();d._ctx=K();for(var f=c.length,g=this.threshold,k=this.depth,n=this.c,r=this.j,q=this.u,p=0;p<f;p++){var l=
c[p];if(l){var m=l.length,v=(q?p+1:f-p)/f,t="";switch(this.h){case "reverse":case "both":for(var u=m;--u;)t=l[u]+t,U(r,d,t,a,q?1:(m-u)/m,v,g,n-1);t="";case "forward":for(u=0;u<m;u++)t+=l[u],U(r,d,t,a,q?(u+1)/m:1,v,g,n-1);break;case "full":for(u=0;u<m;u++)for(var x=(q?u+1:m-u)/m,z=m;z>u;z--)t=l.substring(u,z),U(r,d,t,a,x,v,g,n-1);break;default:if(m=U(r,d,l,a,1,v,g,n-1),k&&1<f&&m>=g)for(m=d._ctx[l]||(d._ctx[l]=K()),l=this.g[l]||(this.g[l]=G(n-(g||0))),v=p-k,t=p+k+1,0>v&&(v=0),t>f&&(t=f);v<t;v++)v!==
p&&U(l,m,c[v],a,0,n-(v<p?p-v:v-p),g,n-1)}}}this.f[a]=1;this.o=!1}return this};
function T(a,b,c,e){if(y(c)){var d=c.length;if(d--){for(var h=0;h<d;h++)T(a,b,c[h]);return T(a,b,c[d],e)}}else{var f=a.a.index,g=a.a.keys,k=a.a.tag;h=a.a.store;var n;var r=a.a.id;d=c;for(var q=0;q<r.length;q++)d=d[r[q]];if("remove"===b&&(delete a.l[d],r=g.length,r--)){for(a=0;a<r;a++)f[g[a]].remove(d);return f[g[r]].remove(d,e)}if(k){for(n=0;n<k.length;n++){var p=k[n];var l=c;r=p.split(":");for(q=0;q<r.length;q++)l=l[r[q]];l="@"+l}n=a.w[p];n=n[l]||(n[l]=[])}r=a.a.field;k=0;for(p=r.length;k<p;k++){q=
r[k];l=c;for(var m=0;m<q.length;m++)l=l[q[m]];q=f[g[k]];"add"===b?q.add(d,l,k===p-1&&e):q.update(d,l,k===p-1&&e)}if(h){e=Object.keys(h);b=K();for(f=0;f<e.length;f++)if(g=e[f],h[g])for(g=g.split(":"),k=r=void 0,p=0;p<g.length;p++)l=g[p],r=(r||c)[l],k=(k||b)[l]=r;c=b}n&&(n[n.length]=c);a.l[d]=c}return a}L.prototype.update=function(a,b,c){if(this.a&&C(a))return T(this,"update",a,b);this.f[a]&&w(b)&&(this.remove(a),this.add(a,b,c,!0));return this};
L.prototype.remove=function(a,b,c){if(this.a&&C(a))return T(this,"remove",a,b);if(this.f[a]){if(!c){if(this.async&&"function"!==typeof importScripts){var e=this;c=new Promise(function(d){setTimeout(function(){e.remove(a,null,!0);e=null;d()})});if(b)c.then(b);else return c;return this}if(b)return this.remove(a,null,!0),b(),this}for(b=0;b<this.c-(this.threshold||0);b++)V(this.j[b],a);this.depth&&V(this.g,a);delete this.f[a];this.o=!1}return this};var W;
function X(a,b,c,e,d,h,f,g,k,n,r){e=ha(e,g?0:h,k,f,c,n,r);if(k){k=e.page;var q=e.next;e=e.result}if(g)e=a.where(g,null,h,e);else{c=e;e=a.l;h=c.length;f=Array(h);for(g=0;g<h;g++)f[g]=e[c[g]];e=f}d&&(A(d)||(W=d.split(":"),1<W.length?d=ia:(W=W[0],d=ja)),e.sort(d));e=Z(k,q,e);a.b&&a.b.set(b,e);return e}
L.prototype.search=function(a,b,c,e){if(C(b)){if(y(b))for(var d=0;d<b.length;d++)b[d].query=a;else b.query=a;a=b;b=1E3}else b&&A(b)?(c=b,b=1E3):b||0===b||(b=1E3);var h=[],f=a;if(C(a)&&!y(a)){c||(c=a.callback)&&(f.callback=null);var g=a.sort;var k=a.page;b=a.limit;var n=a.threshold;var r=a.suggest;a=a.query}if(this.a){n=this.a.index;var q=f.where,p=f.bool||"or",l=f.field,m=p,v,t;if(l)y(l)||(l=[l]);else if(y(f)){var u=f;l=[];m=[];for(var x=0;x<f.length;x++)e=f[x],d=e.bool||p,l[x]=e.field,m[x]=d,"not"===
d?v=!0:"and"===d&&(t=!0)}else l=this.a.keys;p=l.length;for(x=0;x<p;x++)u&&(f=u[x]),k&&!w(f)&&(f.page=null,f.limit=0),h[x]=n[l[x]].search(f,0);if(c)return c(X(this,a,m,h,g,b,r,q,k,t,v));if(this.async){var z=this;return new Promise(function(Y){Promise.all(h).then(function(ka){Y(X(z,a,m,ka,g,b,r,q,k,t,v))})})}return X(this,a,m,h,g,b,r,q,k,t,v)}n||(n=this.threshold||0);if(!e){if(this.async&&"function"!==typeof importScripts){var B=this;n=new Promise(function(Y){setTimeout(function(){Y(B.search(f,b,null,
!0));B=null})});if(c)n.then(c);else return n;return this}if(c)return c(this.search(f,b,null,!0)),this}if(!a||!w(a))return h;f=a;if(this.b)if(this.o){if(c=this.b.get(a))return c}else this.b.clear(),this.o=!0;f=this.encode(f);if(!f.length)return h;c=this.i(f);u=c.length;e=!0;d=[];var N=K(),O=0;1<u&&(this.depth?p=!0:c.sort(la));if(!p||(x=this.g))for(var R=this.c;O<u;O++){var D=c[O];if(D){if(p){if(!l)if(x[D])l=D,N[D]=1;else if(!r)return h;if(r&&O===u-1&&!d.length)p=!1,D=l||D,N[D]=0;else if(!l)continue}if(!N[D]){var E=
[],M=!1,H=0,I=p?x[l]:this.j;if(I)for(var P=void 0,J=0;J<R-n;J++)if(P=I[J]&&I[J][D])E[H++]=P,M=!0;if(M)l=D,d[d.length]=1<H?E.concat.apply([],E):E[0];else if(!r){e=!1;break}N[D]=1}}}else e=!1;e&&(h=ha(d,b,k,r));this.b&&this.b.set(a,h);return h};L.prototype.info=function(){return{id:this.id,items:this.length,matcher:this.m.length,worker:this.B,threshold:this.threshold,depth:this.depth,resolution:this.c,contextual:this.depth&&"strict"===this.h}};L.prototype.clear=function(){return this.destroy().init()};
L.prototype.destroy=function(){this.b&&(this.b.clear(),this.b=null);this.j=this.g=this.f=null;if(this.a){for(var a=this.a.keys,b=0;b<a.length;b++)this.a.index[a[b]].destroy();this.a=this.l=null}return this};function ea(a,b,c){Object.defineProperty(a,b,{get:c})}function U(a,b,c,e,d,h,f,g){if(b[c])return b[c];d=d?(g-(f||g/1.5))*h+(f||g/1.5)*d:h;b[c]=d;d>=f&&(a=a[g-(d+.5>>0)],a=a[c]||(a[c]=[]),a[a.length]=e);return d}
function V(a,b){if(a)for(var c=Object.keys(a),e=0,d=c.length;e<d;e++){var h=c[e],f=a[h];if(f)for(var g=0,k=f.length;g<k;g++)if(f[g]===b){1===k?delete a[h]:f.splice(g,1);break}else C(f[g])&&V(f[g],b)}}L.prototype.encode=function(a){a&&this.s&&(a=this.s(a));a&&this.m.length&&(a=aa(a,this.m));a&&this.v&&(a=aa(a,this.v));return a};
L.prototype.i=function(a){a=y(a)?a:A(this.h)?this.h(a):a.split(this.split);if(this.filter){for(var b=this.filter,c=a.length,e=A(b),d=[],h=0,f=0;h<c;h++){var g=a[h];g&&(e&&b(g)||!e&&!b[g])&&(d[f++]=g)}a=d}return a};function la(a,b){return b.length-a.length}function ja(a,b){return a[W]-b[W]}function ia(a,b){for(var c=W.length,e=0;e<c;e++)a=a[W[e]],b=b[W[e]];return a-b}function Z(a,b,c){return a?{page:a,next:b?""+b:null,result:c}:c}
function ha(a,b,c,e,d,h,f){var g=[];if(!0===c){c="0";var k=""}else k=c&&c.split(":");var n=a.length;if(1<n){var r=K(),q=[],p,l=0,m,v=!0,t=0,u;if(k)if(2===k.length){var x=k;k=!1}else k=u=parseInt(k[0],10);if(f){for(p=K();l<n;l++)if("not"===d[l]){var z=a[l];var B=z.length;for(m=0;m<B;m++)p["@"+z[m]]=1}else var N=l+1;if(F(N))return Z(c,J,g);l=0}else var O=w(d)&&d;for(var R;l<n;l++){var D=l===(N||n)-1;if(!O||!l)if((m=O||d&&d[l])&&"and"!==m)if("or"===m)R=!1;else continue;else R=h=!0;z=a[l];if(B=z.length){if(v)if(H){var E=
H.length;for(m=0;m<E;m++){v=H[m];var M="@"+v;f&&p[M]||(r[M]=1,h||(g[t++]=v))}var H=null;v=!1}else{H=z;continue}M=!1;for(m=0;m<B;m++){E=z[m];var I="@"+E,P=h?r[I]||0:l;if(!(!P&&!e||f&&p[I]||!h&&r[I]))if(P===l){if(D){if(!u||--u<t)if(g[t++]=E,b&&t===b)return Z(c,t+(k||0),g)}else r[I]=l+1;M=!0}else e&&(I=q[P]||(q[P]=[]),I[I.length]=E)}if(R&&!M&&!e)break}else if(R&&!e)return Z(c,J,z)}if(H)if(l=H.length,f)for(m=k?parseInt(k,10):0;m<l;m++)a=H[m],p["@"+a]||(g[t++]=a);else g=H;if(e)for(t=g.length,x?(l=parseInt(x[0],
10)+1,m=parseInt(x[1],10)+1):(l=q.length,m=0);l--;)if(E=q[l]){for(B=E.length;m<B;m++)if(e=E[m],!f||!p["@"+e])if(g[t++]=e,b&&t===b)return Z(c,l+":"+m,g);m=0}}else!n||d&&"not"===d[0]||(g=a[0],k&&(k=parseInt(k[0],10)));if(b){f=g.length;k&&k>f&&(k=0);k=k||0;var J=k+b;J<f?g=g.slice(k,J):(J=0,k&&(g=g.slice(k)))}return Z(c,J,g)};(function(){var a=this||window,b;(b=a.define)&&b.amd?b([],function(){return L}):"object"===typeof a.exports?a.module.exports=L:a.FlexSearch=L})();}).call(this);
