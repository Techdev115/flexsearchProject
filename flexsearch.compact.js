/*
 FlexSearch v0.3.3
 Copyright 2019 Nextapps GmbH
 Author: Thomas Wilkerling
 Released under the Apache 2.0 Licence
 https://github.com/nextapps-de/flexsearch
*/
'use strict';(function(g,u,c){let m;(m=c.define)&&m.amd?m([],function(){return u}):(m=c.modules)?m[g.toLowerCase()]=u:"object"===typeof exports?module.exports=u:c[g]=u})("FlexSearch",function(){function g(a){y(a)&&(a=H[a]);a||(a=v);this.id=a.id||O++;this.init(a);u(this,"index",function(){return this.b});u(this,"length",function(){return Object.keys(this.b).length})}function u(a,b,d){Object.defineProperty(a,b,{get:d})}function c(a){return new RegExp(a,"g")}function m(a,b){for(let d=0;d<b.length;d+=
2)a=a.replace(b[d],b[d+1]);return a}function x(a,b,d,e,f,c,h){if(b[d])return b[d];f=f?(9-(h||6))*c+(h||6)*f:c;b[d]=f;f>=h&&(a=a[9-(f+.5>>0)],a=a[d]||(a[d]=[]),a[a.length]=e);return f}function D(a,b){if(a){const d=Object.keys(a);for(let e=0,f=d.length;e<f;e++){const f=d[e],c=a[f];if(c)for(let d=0,e=c.length;d<e;d++)if(c[d]===b){1===e?delete a[f]:c.splice(d,1);break}else"object"===typeof c[d]&&D(c[d],b)}}}function E(a){let b="",d="";var e="";for(let f=0;f<a.length;f++){const c=a[f];if(c!==d)if(f&&"h"===
c){if(e="a"===e||"e"===e||"i"===e||"o"===e||"u"===e||"y"===e,("a"===d||"e"===d||"i"===d||"o"===d||"u"===d||"y"===d)&&e||" "===d)b+=c}else b+=c;e=f===a.length-1?"":a[f+1];d=c}return b}function P(a,b){a=a.length-b.length;return 0>a?1:a?-1:0}function Q(a,b){a=a.length-b.length;return 0>a?-1:a?1:0}function R(a,b,d){let c=[],f;const z=a.length;if(1<z){a.sort(Q);const e=t();let g=a[0],p=g.length,n=0;for(;n<p;)e["@"+g[n++]]=1;let l,r=0,q=0;for(;++q<z;){let I=!1;const k=q===z-1;f=[];g=a[q];p=g.length;for(n=
0;n<p;){l=g[n++];var h="@"+l;if(e[h]){const a=e[h];if(a===q){if(k){if(c[r++]=l,b&&r===b)return c}else e[h]=q+1;I=!0}else d&&(h=f[a]||(f[a]=[]),h[h.length]=l)}}if(!I&&!d)break}if(d&&(r=c.length,(q=f.length)&&(!b||r<b)))for(;q--;)if(l=f[q])for(let a=0,d=l.length;a<d;a++)if(c[r++]=l[a],b&&r===b)return c}else z&&(c=a[0],b&&c.length>b&&(c=c.slice(0,b)));return c}function y(a){return"string"===typeof a}function A(a){return"function"===typeof a}function B(a){return"undefined"===typeof a}function F(a){a.l||
(a.l=J(function(){a.l=0;{const b=a.async;let d;b&&(a.async=!1);if(a.c.length){const b=Date.now();let c;for(;(c=a.c.shift())||0===c;){d=a.g[c];switch(d[0]){case C.add:a.add(d[1],d[2]);break;case C.remove:a.remove(d[1])}delete a.g[c];if(100<Date.now()-b)break}a.c.length&&F(a)}b&&(a.async=b)}},1,"@"+a.id))}function K(a){const b=Array(a);for(let d=0;d<a;d++)b[d]=t();return b}function t(){return Object.create(null)}const v={encode:"icase",a:"forward",m:!1,cache:!1,async:!1,o:!1,threshold:0,depth:0},H=
{memory:{encode:"extra",a:"strict",threshold:7},speed:{encode:"icase",a:"strict",threshold:7,depth:2},match:{encode:"extra",a:"full"},score:{encode:"extra",a:"strict",threshold:5,depth:4},balance:{encode:"balance",a:"strict",threshold:6,depth:3},fastest:{encode:"icase",a:"strict",threshold:9,depth:1}},G=[];let O=0;const C={add:0,update:1,remove:2},L=c("\\W+"),M={},N={};(function(){const a=Object.getOwnPropertyNames({}.__proto__),b=t();for(let d=0;d<a.length;d++)b[a[d]]=1;return b})();g.create=function(a){return new g(a)};
g.registerMatcher=function(a){for(let b in a)a.hasOwnProperty(b)&&G.push(c(b),a[b]);return this};g.registerEncoder=function(a,b){w[a]=b.bind(w);return this};g.registerLanguage=function(a,b){M[a]=b.filter;N[a]=b.stemmer;return this};g.encode=function(a,b){return w[a](b)};g.prototype.init=function(a){this.j=[];a||(a=v);var b=a.profile,d=b?H[b]:{};this.a=a.tokenize||d.a||this.a||v.a;this.async=B(b=a.async)?this.async||v.async:b;this.threshold=B(b=a.threshold)?d.threshold||this.threshold||v.threshold:
b;this.depth=B(b=a.depth)?d.depth||this.depth||v.depth:b;this.i=(b=B(b=a.encode)?d.encode:b)&&w[b]&&w[b].bind(w)||(A(b)?b:this.i||!1);(b=a.matcher)&&this.addMatcher(b);if(b=a.filter){b=M[b]||b;d=this.i;var e=t();if(b)for(let a=0;a<b.length;a++){const c=d?d(b[a]):b[a];e[c]=String.fromCharCode(65E3-b.length+a)}this.filter=b=e}if(b=a.stemmer){var f;a=N[b]||b;b=this.i;d=[];if(a)for(f in a)a.hasOwnProperty(f)&&(e=b?b(f):f,d.push(c("(?=.{"+(e.length+3)+",})"+e+"$"),b?b(a[f]):a[f]));this.stemmer=f=d}this.h=
K(10-(this.threshold||0));this.f=t();this.b=t();this.g=t();this.c=[];this.l=0;return this};g.prototype.encode=function(a){a&&G.length&&(a=m(a,G));a&&this.j.length&&(a=m(a,this.j));a&&this.i&&(a=this.i(a));a&&this.stemmer&&(a=m(a,this.stemmer));return a};g.prototype.addMatcher=function(a){const b=this.j;for(const d in a)a.hasOwnProperty(d)&&b.push(c(d),a[d]);return this};g.prototype.add=function(a,b,d){if(b&&y(b)&&(a||0===a)){const e="@"+a;if(this.b[e]&&!d)this.update(a,b);else{if(this.async)return this.g[e]||
(this.c[this.c.length]=e),this.g[e]=[C.add,a,b],F(this),this;b=this.encode(b);if(!b.length)return this;d=this.a;b=A(d)?d(b):b.split(L);const p=t();p._ctx=t();const n=this.threshold,l=this.depth,r=this.h,q=b.length;for(let e=0;e<q;e++){var c=b[e];if(c){var f=c.length,g=(q-e)/q,h="";switch(d){case "reverse":case "both":for(var k=f-1;1<=k;k--)h=c[k]+h,x(r,p,h,a,(f-k)/f,g,n);h="";case "forward":for(k=0;k<f;k++)h+=c[k],x(r,p,h,a,1,g,n);break;case "full":for(k=0;k<f;k++){const b=(f-k)/f;for(let d=f;d>k;d--)h=
c.substring(k,d),x(r,p,h,a,b,g,n)}break;default:if(f=x(r,p,c,a,1,g,n),l&&1<q&&f>=n)for(f=p._ctx[c]||(p._ctx[c]=t()),c=this.f[c]||(this.f[c]=K(10-(n||0))),g=e-l,h=e+l+1,0>g&&(g=0),h>q&&(h=q);g<h;g++)g!==e&&x(c,f,b[g],a,0,10-(g<e?e-g:g-e),n)}}}this.b[e]=1}}return this};g.prototype.update=function(a,b){this.b["@"+a]&&y(b)&&(this.remove(a),this.add(a,b,!0));return this};g.prototype.remove=function(a){const b="@"+a;if(this.b[b]){if(this.async)return this.g[b]||(this.c[this.c.length]=b),this.g[b]=[C.remove,
a],F(this),this;for(let b=0;b<10-(this.threshold||0);b++)D(this.h[b],a);this.depth&&D(this.f,a);delete this.b[b]}return this};g.prototype.search=function(a,b,c,e){let d=a,g,h=[];"object"===typeof a&&((c=a.callback||b)&&(d.callback=null),b=a.limit,g=a.threshold,a=a.query);g||(g=this.threshold||0);A(b)?(c=b,b=1E3):b||0===b||(b=1E3);if(c){{let a=this;J(function(){c(a.search(d,b,null,!0));a=null},1,"search-"+this.id)}}else{if(!e&&this.async&&"function"!==typeof importScripts){let a=this;return new Promise(function(c){c(a.search(d,
b,null,!0));a=null})}if(!a||!y(a))return h;d=a;d=this.encode(d);if(!d.length)return h;a=this.a;a=A(a)?a(d):d.split(L);e=a.length;var k=!0,m=[],p=t();if(1<e)if(this.depth){var n=!0;var l=a[0];p[l]=1}else a.sort(P);var r;if(!n||(r=this.f)[l])for(let b=n?1:0;b<e;b++){const c=a[b];if(c){if(!p[c]){const a=[];let b=!1,d=0;if(l=n?r[l]:this.h){let e;for(let f=0;f<10-g;f++)if(e=l[f][c])a[d++]=e,b=!0}if(b)m[m.length]=1<d?a.concat.apply([],a):a[0];else{k=!1;break}p[c]=1}l=c}}else k=!1;k&&(h=R(m,b,!1));return h}};
g.prototype.clear=function(){this.destroy();return this.init()};g.prototype.destroy=function(){this.filter=this.stemmer=this.h=this.f=this.b=this.g=this.c=null;return this};g.prototype.export=function(){return JSON.stringify([this.h,this.f,this.b])};g.prototype.import=function(a){a=JSON.parse(a);this.h=a[0];this.f=a[1];this.b=a[2]};const w={icase:function(a){return a.toLowerCase()},simple:function(){const a=[c("[\u00e0\u00e1\u00e2\u00e3\u00e4\u00e5]"),"a",c("[\u00e8\u00e9\u00ea\u00eb]"),"e",c("[\u00ec\u00ed\u00ee\u00ef]"),
"i",c("[\u00f2\u00f3\u00f4\u00f5\u00f6\u0151]"),"o",c("[\u00f9\u00fa\u00fb\u00fc\u0171]"),"u",c("[\u00fd\u0177\u00ff]"),"y",c("\u00f1"),"n",c("\u00e7"),"c",c("\u00df"),"s",c(" & ")," and ",c("[-/]")," ",c("[^a-z0-9 ]"),"",c("\\s+")," "];return function(b){b=m(b.toLowerCase(),a);return" "!==b?b:""}}(),advanced:function(){const a=[c("ae"),"a",c("ai"),"ei",c("ay"),"ei",c("ey"),"ei",c("oe"),"o",c("ue"),"u",c("ie"),"i",c("sz"),"s",c("zs"),"s",c("sh"),"s",c("ck"),"k",c("cc"),"k",c("dt"),"t",c("ph"),"f",
c("pf"),"f",c("ou"),"o",c("uo"),"u"];return function(b,c){if(!b)return b;b=this.simple(b);2<b.length&&(b=m(b,a));c||1<b.length&&(b=E(b));return b}}(),extra:function(){const a=[c("p"),"b",c("z"),"s",c("[cgq]"),"k",c("n"),"m",c("d"),"t",c("[vw]"),"f",c("[aeiouy]"),""];return function(b){if(!b)return b;b=this.advanced(b,!0);if(1<b.length){b=b.split(" ");for(let c=0;c<b.length;c++){const d=b[c];1<d.length&&(b[c]=d[0]+m(d.substring(1),a))}b=b.join(" ");b=E(b)}return b}}(),balance:function(){const a=[c("[-/]"),
" ",c("[^a-z0-9 ]"),"",c("\\s+")," "];return function(b){return E(m(b.toLowerCase(),a))}}()},J=function(){const a=t();return function(b,c,e){const d=a[e];d&&clearTimeout(d);return a[e]=setTimeout(b,c)}}();return g}(!1),this);
