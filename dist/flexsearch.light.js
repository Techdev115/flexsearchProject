/*
 FlexSearch v0.5.31
 Copyright 2019 Nextapps GmbH
 Author: Thomas Wilkerling
 Released under the Apache 2.0 Licence
 https://github.com/nextapps-de/flexsearch
*/
'use strict';(function(d,w,x){let m;(m=x.define)&&m.amd?m([],function(){return w}):(m=x.modules)?m[d.toLowerCase()]=w:"object"===typeof exports?module.exports=w:x[d]=w})("FlexSearch",function(){function d(a,c){const b=c?c.id:a&&a.id;this.id=b||0===b?b:J++;this.init(a,c);x(this,"index",function(){return this.b});x(this,"length",function(){return Object.keys(this.index).length})}function w(a,c){const b=a.length,f=z(c),e=[];for(let k=0,g=0;k<b;k++){const b=a[k];if(f&&c(b)||!f&&!c[b])e[g++]=b}return e}
function x(a,c,b){Object.defineProperty(a,c,{get:b})}function m(a,c){for(let b=0;b<c.length;b+=2)a=a.replace(c[b],c[b+1]);return a}function A(a,c,b,f,e,k,g,l){if(c[b])return c[b];e=e?(l-(g||l/1.5))*k+(g||l/1.5)*e:k;c[b]=e;e>=g&&(a=a[l-(e+.5>>0)],a=a[b]||(a[b]=[]),a[a.length]=f);return e}function D(a,c){if(a){const b=Object.keys(a);for(let f=0,e=b.length;f<e;f++){const e=b[f],g=a[e];if(g)for(let b=0,f=g.length;b<f;b++)if(g[b]===c){1===f?delete a[e]:g.splice(b,1);break}else"object"===typeof g[b]&&D(g[b],
c)}}}function K(a,c){a=a.length-c.length;return 0>a?1:a?-1:0}function B(a){return"string"===typeof a}function z(a){return"function"===typeof a}function C(a){return"undefined"===typeof a}function F(a){const c=Array(a);for(let b=0;b<a;b++)c[b]=v();return c}function v(){return Object.create(null)}const r={encode:"icase",c:"forward",o:!1,cache:!1,async:!1,s:!1,i:!1,m:!1,l:!1,a:9,threshold:0,depth:0},E=[];let J=0;const G=/\W+/,H={},I={};d.create=function(a){return new d(a)};d.registerMatcher=function(a){for(const c in a)a.hasOwnProperty(c)&&
E.push(new RegExp(c,"g"),a[c]);return this};d.registerEncoder=function(a,c){y[a]=c.bind(y);return this};d.registerLanguage=function(a,c){H[a]=c.filter;I[a]=c.stemmer;return this};d.encode=function(a,c){return y[a](c)};d.prototype.init=function(a,c){this.j=[];if(c){var b=c.preset;a=c}else a||(a=r),b=a.preset;c={};this.c=a.tokenize||c.c||this.c||r.c;this.i=a.rtl||this.i||r.i;this.threshold=C(b=a.threshold)?c.threshold||this.threshold||r.threshold:b;this.a=C(b=a.resolution)?b=c.a||this.a||r.a:b;b<=this.threshold&&
(this.a=this.threshold+1);this.depth=C(b=a.depth)?c.depth||this.depth||r.depth:b;this.l=C(b=a.paging)?this.l||r.l:b;this.g=(b=C(b=a.encode)?c.encode||r.encode:b)&&y[b]&&y[b].bind(y)||(z(b)?b:this.g||!1);(b=a.matcher)&&this.addMatcher(b);if(b=a.filter){B(b)&&(b=H[b]);if(b.constructor===Array){c=this.g;var f=v();for(let a=0;a<b.length;a++){const e=c?c(b[a]):b[a];f[e]=1}b=f}this.filter=b}if(b=a.stemmer){var e;a=B(b)?I[b]:b;b=this.g;c=[];for(e in a)a.hasOwnProperty(e)&&(f=b?b(e):e,c.push(new RegExp(f+
"($|\\W)","g"),b?b(a[e]):a[e]));this.stemmer=e=c}this.h=F(this.a-(this.threshold||0));this.f=v();this.b=v();return this};d.prototype.encode=function(a){a&&E.length&&(a=m(a,E));a&&this.j.length&&(a=m(a,this.j));a&&this.g&&(a=this.g(a));a&&this.stemmer&&(a=m(a,this.stemmer));return a};d.prototype.addMatcher=function(a){const c=this.j;for(const b in a)a.hasOwnProperty(b)&&c.push(new RegExp(b,"g"),a[b]);return this};d.prototype.add=function(a,c,b,f,e){if(c&&B(c)&&(a||0===a)){const d="@"+a;if(this.b[d]&&
!f)return this.update(a,c);if(!e&&b)return this.add(a,c,null,f,!0),b(),this;c=this.encode(c);if(!c.length)return this;b=this.c;c=z(b)?b(c):c.split(G);this.filter&&(c=w(c,this.filter));f=v();f._ctx=v();e=c.length;const q=this.threshold,u=this.depth,p=this.a,t=this.h,m=this.i;for(let d=0;d<e;d++){var k=c[d];if(k){var g=k.length,l=(m?d+1:e-d)/e,n="";switch(b){case "reverse":case "both":for(var h=g;--h;)n=k[h]+n,A(t,f,n,a,m?1:(g-h)/g,l,q,p-1);n="";case "forward":for(h=0;h<g;h++)n+=k[h],A(t,f,n,a,m?(h+
1)/g:1,l,q,p-1);break;case "full":for(h=0;h<g;h++){const b=(m?h+1:g-h)/g;for(let c=g;c>h;c--)n=k.substring(h,c),A(t,f,n,a,b,l,q,p-1)}break;default:if(g=A(t,f,k,a,1,l,q,p-1),u&&1<e&&g>=q)for(g=f._ctx[k]||(f._ctx[k]=v()),k=this.f[k]||(this.f[k]=F(p-(q||0))),l=d-u,n=d+u+1,0>l&&(l=0),n>e&&(n=e);l<n;l++)l!==d&&A(k,g,c[l],a,0,p-(l<d?d-l:l-d),q,p-1)}}}this.b[d]=1}return this};d.prototype.update=function(a,c,b){this.b["@"+a]&&B(c)&&(this.remove(a),this.add(a,c,b,!0));return this};d.prototype.remove=function(a,
c,b){const f="@"+a;if(this.b[f]){if(!b&&c)return this.remove(a,null,!0),c(),this;for(c=0;c<this.a-(this.threshold||0);c++)D(this.h[c],a);this.depth&&D(this.f,a);delete this.b[f]}return this};d.prototype.search=function(a,c,b,f){var e=[],d=a;if("object"===typeof a){c=a.limit;var g=a.threshold;a=a.query}g||(g=this.threshold||0);z(c)?(b=c,c=1E3):c||0===c||(c=1E3);if(!f&&b)return b(this.search(d,c,null,!0)),this;if(!a||!B(a))return e;d=this.encode(a);if(!d.length)return e;a=this.c;a=z(a)?a(d):d.split(G);
this.filter&&(a=w(a,this.filter));b=a.length;f=!0;d=[];var l=v();if(1<b)if(this.depth){var n=!0;var h=a[0];l[h]=1}else a.sort(K);var m;if(!n||(m=this.f)[h]){var q=this.a;for(var u=n?1:0;u<b;u++){var p=a[u];if(p){if(!l[p]){var t=[],r=!1;let a=0;if(h=n?m[h]:this.h){let b;for(let c=0;c<q-g;c++)if(b=h[c][p])t[a++]=b,r=!0}if(r)d[d.length]=1<a?t.concat.apply([],t):t[0];else{f=!1;break}l[p]=1}h=p}}}else f=!1;if(f)a:if(e=[],g=d.length,1<g){n=v();h=-1;u=!0;let k;for(f=0;++h<g;){l=h===g-1;m=d[h];b=m.length;
if(!b){e=m;break a}if(u)if(k){q=k.length;for(a=0;a<q;)n["@"+k[a++]]=1;k=null;u=!1}else{k=m;continue}p=!1;for(a=0;a<b;)if(q=m[a++],t="@"+q,(r=n[t])&&r===h){if(l){if(e[f++]=q,c&&f===c)break a}else n[t]=h+1;p=!0}if(!p)break}k&&(e=k)}else g&&(e=d[0],c&&e.length>c&&(e=e.slice(0,c)));return e};d.prototype.clear=function(){return this.destroy().init()};d.prototype.destroy=function(){this.h=this.f=this.b=null;return this};const y={icase:function(a){return a.toLowerCase()}};return d}(!1),this);
